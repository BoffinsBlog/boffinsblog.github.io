<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Installing Gitea | Boffins Blog</title>
<meta name="keywords" content="Linux, Raspberry Pi, Self Hosting, Software, Web-Servers">
<meta name="description" content="Everything from downloading to securing your installation. Now with bash scripts to upload and update Gitea repositories.">
<meta name="author" content="Boffin">
<link rel="canonical" href="https://boffinsblog.github.io/posts/installing-gitea/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e13be8719bbabf4005d0d2b0f19dba897f7d41b2e807b64c47ee1436d126ab01.css" integrity="sha256-4TvocZu6v0AF0NKw8Z26iX99QbLoB7ZMR&#43;4UNtEmqwE=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://boffinsblog.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://boffinsblog.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://boffinsblog.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://boffinsblog.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://boffinsblog.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://boffinsblog.github.io/posts/installing-gitea/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="https://boffinsblog.github.io/posts/installing-gitea/">
  <meta property="og:site_name" content="Boffins Blog">
  <meta property="og:title" content="Installing Gitea">
  <meta property="og:description" content="Everything from downloading to securing your installation. Now with bash scripts to upload and update Gitea repositories.">
  <meta property="og:locale" content="en-gb">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-11-10T10:53:17+00:00">
    <meta property="article:modified_time" content="2023-11-10T10:53:17+00:00">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Raspberry Pi">
    <meta property="article:tag" content="Self Hosting">
    <meta property="article:tag" content="Software">
    <meta property="article:tag" content="Web-Servers">
    <meta property="og:image" content="https://boffinsblog.github.io/posts/installing-gitea/01_Gitea_Homepage_Screenshot.webp">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://boffinsblog.github.io/posts/installing-gitea/01_Gitea_Homepage_Screenshot.webp">
<meta name="twitter:title" content="Installing Gitea">
<meta name="twitter:description" content="Everything from downloading to securing your installation. Now with bash scripts to upload and update Gitea repositories.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://boffinsblog.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Installing Gitea",
      "item": "https://boffinsblog.github.io/posts/installing-gitea/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Installing Gitea",
  "name": "Installing Gitea",
  "description": "Everything from downloading to securing your installation. Now with bash scripts to upload and update Gitea repositories.",
  "keywords": [
    "Linux", "Raspberry Pi", "Self Hosting", "Software", "Web-Servers"
  ],
  "articleBody": "Self hosting is not everyone’s cup of tea With GitHub repositories becoming the krill for Microsoft’s behemoth AI, and Codeberg still broken, it was time to get around to installing Gitea.\nGetting stuff ready Resources As usual, I scoured the Internets for several hours and read everything I could find.\nHowever this was kind of pointless as most of the Gitea installation instructions can be found in the official documentation .\nUpdate everything Firstly, update everything and get ready to install.\nsudo apt update \u0026\u0026 sudo apt upgrade\nThen, add a couple of necessary packages (these may already be installed):\nsudo apt install wget\nsudo apt install git\nnginx part I – pre Certbot I tend to run my nginx setup in three parts:\nFirst, a base setup to get things up and running and test that everything works\nThen, grab a HTTPS Certificate using Certbot\nThen, add the Certificate and restart nginx\nStart setting up the initial nginx conf file by running the following in a Terminal:\nsudo nano /etc/nginx/sites-available/GITEA\nWith the example copied from here :\nserver { listen 80; server_name git.example.com; location / { client_max_body_size 512M; proxy_pass http://localhost:3000; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } } Then, ‘enable’ the site by creating a symlink:\nsudo ln -s /etc/nginx/sites-available/GITEA/etc/nginx/sites-enabled/\nCheck and reload nginx Then make sure it all works:\nsudo nginx -t \u0026\u0026 sudo systemctl reload nginx\nCertbot I already have a HTTPS site running on this server (you are reading it) so there was no need for me to install extra Certbot software.\nI would like the Gitea connection to be over HTTPS too, so for me, adding an extra certificate was a matter of running:\nsudo certbot certonly --nginx -d git.example.com\n( There is a guide on how to install Certbot however. )\nnginx part II – post Certbot Now that the site is up and running and the Certificate issued, I can replace the earlier one with the following:\n(The additional lines come from the excellent Digital Ocean nginx config generator .)\n# Upstream server upstream gitea { server 192.168.0.90:3003; } server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name git.example.com; # set ; root /usr/local/bin/gitea; # SSL ssl_certificate /etc/letsencrypt/live/git.example.com/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/git.example.com/privkey.pem; ssl_trusted_certificate /etc/letsencrypt/live/git.example.com/chain.pem; # security include nginxconfig.io/security.conf; # restrict methods if ($request_method !~ ^(GET|POST|HEAD)$) { return '405'; } location / { try_files maintain.html $uri $uri/index.html @node; } location @node { client_max_body_size 0; proxy_pass http://localhost:3003; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Real-IP $remote_addr; proxy_set_header Host $http_host; proxy_set_header X-Forwarded-Proto $scheme; proxy_max_temp_file_size 0; proxy_redirect off; proxy_read_timeout 120; } } # HTTP redirect server { listen 80; listen [::]:80; server_name git.example.com; include nginxconfig.io/letsencrypt.conf; location / { return 301 git.example.com$request_uri; } } Check and reload nginx once more Then make sure it all still works:\nsudo nginx -t \u0026\u0026 sudo systemctl reload nginx\nSetup ufw Next, Gitea need to be able to be seen from the outside world.\nI use ‘ufw’ or ‘ Uncomplicated Firewall ‘ so I need to allow traffic to the Gitea port.\nFirst, see all of the existing connections:\nsudo ufw verbose\nThen, allow tcp traffic on the Gitea port:\nsudo ufw allow 3003/tcp comment \"Gitea tcp traffic\"\nThen, allow udp traffic on the Gitea port:\nsudo ufw allow 3003/udp comment \"Gitea udp traffic\"\nCreate a user to run Gitea I prefer to run dedicated processes with a dedicated user.\nTo add a new user run the following in a Terminal:\nadduser \\ --system \\ --shell /bin/bash \\ --gecos 'Git Version Control' \\ --group \\ --disabled-password \\ --home /home/git \\ git Or:\nsudo adduser --system --shell /bin/bash --gecos 'Git Version Control' --group --disabled-password --home /home/git git\nCreate a Gitea database Like Certbot I already have MariaDB installed and running as it is the DB behind this WordPress site.\nIf needed, install by running the following in a Terminal:\nsudo apt install mariadb-server -y\nHowever if this is the first time MariaDB has been installed it is a good idea to run through an initial setup in a Terminal:\nsudo mysql_secure_installation\nTo check that it’s running and to start on a reboot, run the following in a Terminal:\nsudo systemctl start mariadb\nsudo systemctl enable mariadb\nsudo systemctl status mariadb\nTo add the Gitea database run the following in a Terminal:\nsudo mysql -u root -p\nCREATE DATABASE gitea;\nGRANT ALL PRIVILEGES ON gitea.* TO 'gitea'@'localhost' IDENTIFIED BY \"super_long_password_goes_here\";\nFLUSH PRIVILEGES;\nQUIT;\nCreate the required directory structure Before downloading, Gitea needs a place to live.\nRun the following in a Terminal to create the directories:\nsudo mkdir -p /var/lib/gitea/{custom,data,log}\nThen, own them:\nsudo chown -R git:git /var/lib/gitea/\nThen, set the appropriate permissions:\nsudo chmod -R 750 /var/lib/gitea/\nNow create the /etc/ directory:\nsudo mkdir /etc/gitea\nThen, own it:\nsudo chown root:git /etc/gitea\nThen, set the appropriate permissions:\nsudo chmod 770 /etc/gitea\nNOTE: /etc/gitea is temporarily set with write permissions for user git so that the web installer can write the configuration file.\nAfter the installation is finished, it is recommended to set permissions to read-only using:\nchmod 750 /etc/gitea\nchmod 640 /etc/gitea/app.ini\nDownload and install Run the following in a Terminal:\nwget -O gitea https://dl.gitea.com/gitea/1.21/gitea-1.21-linux-arm-6\nchmod +x gitea\nCopy the Gitea binary to a global location Run the following in a Terminal:\nsudo cp gitea /usr/local/bin/gitea\nCreate a systemd unit file I want Gitea to start up after a reboot so I create a systemd unit file and enable it.\nThe following uses wget to grab the latest version from the Gitea repo and saves a copy to the /etc/systemd/system/ folder:\nsudo wget https://raw.githubusercontent.com/go-gitea/gitea/main/contrib/systemd/gitea.service -P /etc/systemd/system/\nEdit the downloaded file to start on a different port:\nsudo nano /etc/systemd/system/gitea.service\nBy changing:\nExecStart=/usr/local/bin/gitea web --config /etc/gitea/app.ini\nTo:\nExecStart=/usr/local/bin/gitea web -p 3003 --config /etc/gitea/app.ini\nCheck and reload Gitea First, enable, this will ensure that the service restarts after a reboot:\nsudo systemctl enable gitea.service\nThen, start the service:\nsudo systemctl start gitea.service\nThen, check the status of the service to see if it is running:\nsudo systemctl status gitea.service\nFinish installation In a browser finish setting up the installation.\ngit.example.com\nSite Title – Can Be Whatever You Like\nAdministrator Account Settings:\nThe first account created will automatically become an Administrator.\nPress the big button, ‘Install Gitea’.\nAdditional users can now be enrolled or added.\nNOTE: There might be a timeout on first start.\nRunning ‘sudo systemctl start gitea.service‘ again seems to resolve this.\nPost Install As mentioned previously it is recommended to set permissions to read-only using:\nsudo chmod 750 /etc/gitea\nsudo chmod 640 /etc/gitea/app.ini\nConnecting with SSH NOTE: These steps are done on the local machine that will connect to Gitea, not the server where Gitea is installed.\nhttps://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent Key Management Create a new key ssh-keygen -t ed25519 -C \"user@example.com\"\nGenerating a key will give it a default name.\nI don’t like the default names even though they make sense, so I rename the keys to something I can remember.\nmv id_ed25519 gitea\nmv id_ed25519.pub gitea.pub\nEdit the config sudo nano ~/.ssh/config\nHost gitea User git HostName git.example.com IdentityFile ~/.ssh/gitea IdentitiesOnly=yes Restart SSH sudo systemctl restart ssh\nAdding the SSH key to the ssh-agent Start the ssh-agent in the background:\neval \"$(ssh-agent -s)\"\nAdd the SSH private key to the ssh-agent ssh-add ~/.ssh/gitea\nAdd the SSH public key to Gitea Copy the Public Key:\ncat ~/.ssh/gitea.pub\nCopy the Terminal output\nLog into Gitea\nSettings | SSH GPG Keys | Add Key\nKey Name – Gitea SSH Key\nPaste and ‘Add Key’\nConnect with SSH In a Terminal:\nssh gitea\nWill return the expected error message:\n‘Hi there, User! You’ve successfully authenticated with the key named Gitea SSH Key, but Gitea does not provide shell access.’\nSending to Gitea using SSH Create a repository in Gitea e.g. ‘Arduino’.\nTick ‘Initialize Repository’ and create.\nInitialise locally e.g.\ncd /foo/Git/Arduino/\ngit init\nEdit the config to use the SSH Key:\nsudo nano /foo/Git/Arduino/.git/config\n[remote \"origin\"] url = gitea:User/Arduino.git Send (force -f) an initial commit:\ngit add .\ngit commit -m \"Initial Commit\"\ngit push -f origin main\nSubsequent pushes using ‘git push -u origin main‘ will be fine.\nTinkering Turn off registrations As I noted earlier I am the only user here and only ever will be so there is no sense in having registrations open for other people to sign up to.\nSo I turn off registrations:\nsudo nano /etc/gitea/app.ini\nDISABLE_REGISTRATION = true Disable OpenID sign-ins Again, I’m the only user so I disable OpenID sign-ins:\n[openid] ENABLE_OPENID_SIGNIN = false ENABLE_OPENID_SIGNUP = false Set up Mailer (Mailjet) In case I bungle something sign-in related, I can use Mailjet to resend a password to a verified email address:\n[mailer] ENABLED = true SMTP_ADDR = in-v3.mailjet.com SMTP_PORT = 587 USER = mailjet_user_id PASSWD = mailjet_user_key FROM = gitea@example.com Set the ‘Landing Page’ As noted earlier, I’m the only user here and probably always will be.\nIt makes no sense to have an incoming browser land on the Gitea homepage, so rather than fiddle with nginx redirects Gitea allows the application to set a ‘landing page’.\nIn the [server] section, change:\nLANDING_PAGE = https://server.IP/user Check and reload Gitea once more Then make sure it all still works.\nsudo systemctl restart gitea.service\nThen, check the ‘status’.\nsudo systemctl status gitea.service\nSome scripts Gitea Repository Screenshot\nGitea will look familiar to anyone who has used a remote Git repository like GitHub or Codeberg in the past.\nHowever right now my installation is empty; it needs a few repositories migrating to it.\nThe following two (2) scripts live locally at /foo/Git/ and assume that:\nA local repository exists at /foo/Git/Arduino/\nA local repository exists at /foo/Git/Calckey/\nAlso that:\nA remote repository exists at git.example.com/User/Arduino\nA remote repository exists at git.example.com/User/Calckey\n(I keep the local repository names the same as the remote repository names to prevent brain ache.)\ngit_init_everything.sh The first script loops through all of the directory names in the array and re-initialises them.\nIt then deletes all of the local history, commits etc.\nIt then ‘pushes’ the local repository to the pre-existing remote repository.\n#!/bin/bash clear # Re-initialise and Push everything to Gitea... echo -e '\\e[1;33mRe-initialise and Push everything to Gitea...\\e[0m'; echo ''; function initGit { local -n arr=$1 for i in \"${arr[@]}\" do # Initialise the local git repo... echo -e '\\e[1;36mInitialise the local' $i 'git repo...\\e[0m'; # Remove the old repo... echo -e '\\e[32mRemove the old' $i 'repo...\\e[0m'; cd /foo/$i/; sudo rm -R .git; # Create the new local repo... echo -e '\\e[32mCreate the new' $i 'local repo...\\e[0m'; git init; # Update the local config file... echo -e '\\e[32mUpdate the local' $i 'config file...\\e[0m'; echo '[remote \"origin\"]' \u003e\u003e .git/config; echo ' url = git_gitea:Boffin/'$i'.git' \u003e\u003e .git/config; # Push the local files to the remote repo with an initial commit... echo -e '\\e[32mPush the local' $i 'files to the remote repo with an initial commit...\\e[0m'; git add .; git commit -m \"Initial Commit\"; git push -f origin main; # Done echo -e '\\e[1;36m'$i 'done\\e[0m'; echo ''; done } # Define the array of all the directory names array=( \"Arduino\" \"Calckey\" ) # Loop initGit array # Everything done echo -e '\\e[1;33mEverything done\\e[0m'; git_update_everything.sh Then the second script loops through all of the directory names in the array and updates them.\nIt then ‘pushes’ the local repository to the pre-existing remote repository.\n#!/bin/bash clear # Push everything to Gitea... echo -e '\\e[1;33mPush everything to Gitea...\\e[0m'; echo ''; function updateGit { local -n arr=$1 for i in \"${arr[@]}\" do # Update the remote git repo... echo -e '\\e[1;36mUpdate the remote' $i 'git repo...\\e[0m' cd /foo/$i/ git add . git commit -m 'Modified' .; git push -u origin main; # Done echo -e '\\e[1;36m'$i 'done\\e[0m' echo '' done } # Define the array of all the directory names array=( \"Arduino\" \"Calckey\" ) # Loop updateGit array # Everything done echo -e '\\e[1;33mEverything done\\e[0m'; As the traditional spaces people have used to share code and ideas disappear, or become the input for training models, I truly believe that self hosted applications like Gitea can empower us.\nSo, if you have a website living on a Pi under your telly, there’s no reason you can’t have a git repository living next to it too.\n",
  "wordCount" : "2022",
  "inLanguage": "en",
  "image":"https://boffinsblog.github.io/posts/installing-gitea/01_Gitea_Homepage_Screenshot.webp","datePublished": "2023-11-10T10:53:17Z",
  "dateModified": "2023-11-10T10:53:17Z",
  "author":{
    "@type": "Person",
    "name": "Boffin"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://boffinsblog.github.io/posts/installing-gitea/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Boffins Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://boffinsblog.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://boffinsblog.github.io/" accesskey="h" title="Boffins Blog (Alt + H)">Boffins Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://boffinsblog.github.io/categories/featured/" title="Featured">
                    <span>Featured</span>
                </a>
            </li>
            <li>
                <a href="https://boffinsblog.github.io/categories" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://boffinsblog.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://boffinsblog.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://boffinsblog.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Installing Gitea
    </h1>
    <div class="post-meta"><span title='2023-11-10 10:53:17 +0000 GMT'>November 10, 2023</span>&nbsp;·&nbsp;<span>10 min</span>&nbsp;·&nbsp;<span>Boffin</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#self-hosting-is-not-everyones-cup-of-tea" aria-label="Self hosting is not everyone’s cup of tea">Self hosting is not everyone’s cup of tea</a></li>
                <li>
                    <a href="#getting-stuff-ready" aria-label="Getting stuff ready">Getting stuff ready</a><ul>
                        
                <li>
                    <a href="#resources" aria-label="Resources">Resources</a></li>
                <li>
                    <a href="#update-everything" aria-label="Update everything">Update everything</a></li>
                <li>
                    <a href="#nginx-part-i--pre-certbot" aria-label="nginx part I – pre Certbot">nginx part I – pre Certbot</a><ul>
                        
                <li>
                    <a href="#check-and-reload-nginx" aria-label="Check and reload nginx">Check and reload nginx</a></li></ul>
                </li>
                <li>
                    <a href="#certbot" aria-label="Certbot">Certbot</a></li>
                <li>
                    <a href="#nginx-part-ii--post-certbot" aria-label="nginx part II – post Certbot">nginx part II – post Certbot</a><ul>
                        
                <li>
                    <a href="#check-and-reload-nginx-once-more" aria-label="Check and reload nginx once more">Check and reload nginx once more</a></li></ul>
                </li>
                <li>
                    <a href="#setup-ufw" aria-label="Setup ufw">Setup ufw</a></li>
                <li>
                    <a href="#create-a-user-to-run-gitea" aria-label="Create a user to run Gitea">Create a user to run Gitea</a></li>
                <li>
                    <a href="#create-a-gitea-database" aria-label="Create a Gitea database">Create a Gitea database</a></li>
                <li>
                    <a href="#create-the-required-directory-structure" aria-label="Create the required directory structure">Create the required directory structure</a></li></ul>
                </li>
                <li>
                    <a href="#download-and-install" aria-label="Download and install">Download and install</a><ul>
                        
                <li>
                    <a href="#copy-the-gitea-binary-to-a-global-location" aria-label="Copy the Gitea binary to a global location">Copy the Gitea binary to a global location</a></li>
                <li>
                    <a href="#create-a-systemd-unit-file" aria-label="Create a systemd unit file">Create a systemd unit file</a><ul>
                        
                <li>
                    <a href="#check-and-reload-gitea" aria-label="Check and reload Gitea">Check and reload Gitea</a></li></ul>
                </li>
                <li>
                    <a href="#finish-installation" aria-label="Finish installation">Finish installation</a><ul>
                        
                <li>
                    <a href="#post-install" aria-label="Post Install">Post Install</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#connecting-with-ssh" aria-label="Connecting with SSH">Connecting with SSH</a><ul>
                        
                <li>
                    <a href="#key-management" aria-label="Key Management">Key Management</a><ul>
                        
                <li>
                    <a href="#create-a-new-key" aria-label="Create a new key">Create a new key</a></li>
                <li>
                    <a href="#edit-the-config" aria-label="Edit the config">Edit the config</a></li>
                <li>
                    <a href="#restart-ssh" aria-label="Restart SSH">Restart SSH</a></li>
                <li>
                    <a href="#adding-the-ssh-key-to-the-ssh-agent" aria-label="Adding the SSH key to the ssh-agent">Adding the SSH key to the ssh-agent</a></li>
                <li>
                    <a href="#add-the-ssh-private-key-to-the-ssh-agent" aria-label="Add the SSH private key to the ssh-agent">Add the SSH private key to the ssh-agent</a></li>
                <li>
                    <a href="#add-the-ssh-public-key-to-gitea" aria-label="Add the SSH public key to Gitea">Add the SSH public key to Gitea</a></li></ul>
                </li>
                <li>
                    <a href="#connect-with-ssh" aria-label="Connect with SSH">Connect with SSH</a></li>
                <li>
                    <a href="#sending-to-gitea-using-ssh" aria-label="Sending to Gitea using SSH">Sending to Gitea using SSH</a></li></ul>
                </li>
                <li>
                    <a href="#tinkering" aria-label="Tinkering">Tinkering</a><ul>
                        
                <li>
                    <a href="#turn-off-registrations" aria-label="Turn off registrations">Turn off registrations</a></li>
                <li>
                    <a href="#disable-openid-sign-ins" aria-label="Disable OpenID sign-ins">Disable OpenID sign-ins</a></li>
                <li>
                    <a href="#set-up-mailer-mailjet" aria-label="Set up Mailer (Mailjet)">Set up Mailer (Mailjet)</a></li>
                <li>
                    <a href="#set-the-landing-page" aria-label="Set the ‘Landing Page’">Set the ‘Landing Page’</a><ul>
                        
                <li>
                    <a href="#check-and-reload-gitea-once-more" aria-label="Check and reload Gitea once more">Check and reload Gitea once more</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#some-scripts" aria-label="Some scripts">Some scripts</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="self-hosting-is-not-everyones-cup-of-tea">Self hosting is not everyone’s cup of tea<a hidden class="anchor" aria-hidden="true" href="#self-hosting-is-not-everyones-cup-of-tea">#</a></h2>
<p>With GitHub repositories becoming the krill for Microsoft’s behemoth AI, and Codeberg still broken, it was time to get around to installing Gitea.</p>
<h2 id="getting-stuff-ready">Getting stuff ready<a hidden class="anchor" aria-hidden="true" href="#getting-stuff-ready">#</a></h2>
<h3 id="resources">Resources<a hidden class="anchor" aria-hidden="true" href="#resources">#</a></h3>
<p>As usual, I scoured the Internets for several hours and read everything I could find.</p>
<p>However this was kind of pointless as most of the Gitea installation instructions can be found in the 

<a href="https://docs.gitea.com/installation/install-from-binary" target="_blank" rel="nofollow noopener noreferrer">official documentation</a>
.</p>
<h3 id="update-everything">Update everything<a hidden class="anchor" aria-hidden="true" href="#update-everything">#</a></h3>
<p>Firstly, update everything and get ready to install.</p>
<p><code>sudo apt update &amp;&amp; sudo apt upgrade</code></p>
<p>Then, add a couple of necessary packages (these may already be installed):</p>
<p><code>sudo apt install wget</code></p>
<p><code>sudo apt install git</code></p>
<h3 id="nginx-part-i--pre-certbot">nginx part I – pre Certbot<a hidden class="anchor" aria-hidden="true" href="#nginx-part-i--pre-certbot">#</a></h3>
<p>I tend to run my nginx setup in three parts:</p>
<ul>
<li>
<p>First, a base setup to get things up and running and test that everything works</p>
</li>
<li>
<p>Then, grab a HTTPS Certificate using Certbot</p>
</li>
<li>
<p>Then, add the Certificate and restart nginx</p>
</li>
</ul>
<p>Start setting up the initial nginx conf file by running the following in a Terminal:</p>
<p><code>sudo nano /etc/nginx/sites-available/GITEA</code></p>
<p>With the example copied from 

<a href="https://docs.gitea.com/administration/reverse-proxies" target="_blank" rel="nofollow noopener noreferrer">here</a>
:</p>
<pre tabindex="0"><code>server {
    listen 80;
    server_name git.example.com;

    location / {
        client_max_body_size 512M;
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
</code></pre><p>Then, ‘enable’ the site by creating a symlink:</p>
<p><code>sudo ln -s /etc/nginx/sites-available/GITEA/etc/nginx/sites-enabled/</code></p>
<h4 id="check-and-reload-nginx">Check and reload nginx<a hidden class="anchor" aria-hidden="true" href="#check-and-reload-nginx">#</a></h4>
<p>Then make sure it all works:</p>
<p><code>sudo nginx -t &amp;&amp; sudo systemctl reload nginx</code></p>
<h3 id="certbot">Certbot<a hidden class="anchor" aria-hidden="true" href="#certbot">#</a></h3>
<p>I already have a HTTPS site running on this server (you are reading it) so there was no need for me to install extra Certbot software.</p>
<p>I would like the Gitea connection to be over HTTPS too, so for me, adding an extra certificate was a matter of running:</p>
<p><code>sudo certbot certonly --nginx -d git.example.com</code></p>
<p>(

<a href="https://certbot.eff.org/instructions?ws=nginx&amp;os=ubuntufocal" target="_blank" rel="nofollow noopener noreferrer">There is a guide on how to install Certbot however.</a>
)</p>
<h3 id="nginx-part-ii--post-certbot">nginx part II – post Certbot<a hidden class="anchor" aria-hidden="true" href="#nginx-part-ii--post-certbot">#</a></h3>
<p>Now that the site is up and running and the Certificate issued, I can replace the earlier one with the following:</p>
<p>(The additional lines come from the excellent 

<a href="https://www.digitalocean.com/community/tools/nginx" target="_blank" rel="nofollow noopener noreferrer">Digital Ocean nginx config generator</a>
.)</p>
<pre tabindex="0"><code># Upstream server
upstream gitea {
    server 192.168.0.90:3003;
}

server {
    listen                  443 ssl http2;
    listen                  [::]:443 ssl http2;
    server_name             git.example.com;
    # set ;
    root                    /usr/local/bin/gitea;

    # SSL
    ssl_certificate         /etc/letsencrypt/live/git.example.com/fullchain.pem;
    ssl_certificate_key     /etc/letsencrypt/live/git.example.com/privkey.pem;
    ssl_trusted_certificate /etc/letsencrypt/live/git.example.com/chain.pem;

    # security
    include                 nginxconfig.io/security.conf;

    # restrict methods
    if ($request_method !~ ^(GET|POST|HEAD)$) {
        return &#39;405&#39;;
    }

    location / {
      try_files maintain.html $uri $uri/index.html @node;
    }

    location @node {
      client_max_body_size 0;
      proxy_pass http://localhost:3003;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header Host $http_host;
      proxy_set_header X-Forwarded-Proto $scheme;
      proxy_max_temp_file_size 0;
      proxy_redirect off;
      proxy_read_timeout 120;
    }
}

# HTTP redirect
server {
    listen      80;
    listen      [::]:80;
    server_name git.example.com;
    include     nginxconfig.io/letsencrypt.conf;

    location / {
        return 301 git.example.com$request_uri;
    }
}
</code></pre><h4 id="check-and-reload-nginx-once-more">Check and reload nginx once more<a hidden class="anchor" aria-hidden="true" href="#check-and-reload-nginx-once-more">#</a></h4>
<p>Then make sure it all still works:</p>
<p><code>sudo nginx -t &amp;&amp; sudo systemctl reload nginx</code></p>
<h3 id="setup-ufw">Setup ufw<a hidden class="anchor" aria-hidden="true" href="#setup-ufw">#</a></h3>
<p>Next, Gitea need to be able to be seen from the outside world.</p>
<p>I use ‘ufw’ or ‘

<a href="https://help.ubuntu.com/community/UFW" target="_blank" rel="nofollow noopener noreferrer">Uncomplicated Firewall</a>
‘ so I need to allow traffic to the Gitea port.</p>
<p>First, see all of the existing connections:</p>
<p><code>sudo ufw verbose</code></p>
<p>Then, allow tcp traffic on the Gitea port:</p>
<p><code>sudo ufw allow 3003/tcp comment &quot;Gitea tcp traffic&quot;</code></p>
<p>Then, allow udp traffic on the Gitea port:</p>
<p><code>sudo ufw allow 3003/udp comment &quot;Gitea udp traffic&quot;</code></p>
<h3 id="create-a-user-to-run-gitea">Create a user to run Gitea<a hidden class="anchor" aria-hidden="true" href="#create-a-user-to-run-gitea">#</a></h3>
<p>I prefer to run dedicated processes with a dedicated user.</p>
<p>To add a new user run the following in a Terminal:</p>
<pre tabindex="0"><code>adduser \
   --system \
   --shell /bin/bash \
   --gecos &#39;Git Version Control&#39; \
   --group \
   --disabled-password \
   --home /home/git \
   git
</code></pre><p>Or:</p>
<p><code>sudo adduser --system --shell /bin/bash --gecos 'Git Version Control' --group --disabled-password --home /home/git git</code></p>
<h3 id="create-a-gitea-database">Create a Gitea database<a hidden class="anchor" aria-hidden="true" href="#create-a-gitea-database">#</a></h3>
<p>Like Certbot I already have MariaDB installed and running as it is the DB behind this WordPress site.</p>
<p>If needed, install by running the following in a Terminal:</p>
<p><code>sudo apt install mariadb-server -y</code></p>
<p>However if this is the first time MariaDB has been installed it is a good idea to run through an initial setup in a Terminal:</p>
<p><code>sudo mysql_secure_installation</code></p>
<p>To check that it’s running and to start on a reboot, run the following in a Terminal:</p>
<p><code>sudo systemctl start mariadb</code></p>
<p><code>sudo systemctl enable mariadb</code></p>
<p><code>sudo systemctl status mariadb</code></p>
<p>To add the Gitea database run the following in a Terminal:</p>
<p><code>sudo mysql -u root -p</code></p>
<p><code>CREATE DATABASE gitea;</code></p>
<p><code>GRANT ALL PRIVILEGES ON gitea.* TO 'gitea'@'localhost' IDENTIFIED BY &quot;super_long_password_goes_here&quot;;</code></p>
<p><code>FLUSH PRIVILEGES;</code></p>
<p><code>QUIT;</code></p>
<h3 id="create-the-required-directory-structure">Create the required directory structure<a hidden class="anchor" aria-hidden="true" href="#create-the-required-directory-structure">#</a></h3>
<p>Before downloading, Gitea needs a place to live.</p>
<p>Run the following in a Terminal to create the directories:</p>
<p><code>sudo mkdir -p /var/lib/gitea/{custom,data,log}</code></p>
<p>Then, own them:</p>
<p><code>sudo chown -R git:git /var/lib/gitea/</code></p>
<p>Then, set the appropriate permissions:</p>
<p><code>sudo chmod -R 750 /var/lib/gitea/</code></p>
<p>Now create the <code>/etc/</code> directory:</p>
<p><code>sudo mkdir /etc/gitea</code></p>
<p>Then, own it:</p>
<p><code>sudo chown root:git /etc/gitea</code></p>
<p>Then, set the appropriate permissions:</p>
<p><code>sudo chmod 770 /etc/gitea</code></p>
<p><strong>NOTE:</strong> <code>/etc/gitea</code> is temporarily set with write permissions for user git so that the web installer can write the configuration file.</p>
<p>After the installation is finished, it is recommended to set permissions to read-only using:</p>
<p><code>chmod 750 /etc/gitea</code></p>
<p><code>chmod 640 /etc/gitea/app.ini</code></p>
<h2 id="download-and-install">Download and install<a hidden class="anchor" aria-hidden="true" href="#download-and-install">#</a></h2>
<p>Run the following in a Terminal:</p>
<p><code>wget -O gitea https://dl.gitea.com/gitea/1.21/gitea-1.21-linux-arm-6</code></p>
<p><code>chmod +x gitea</code></p>
<h3 id="copy-the-gitea-binary-to-a-global-location">Copy the Gitea binary to a global location<a hidden class="anchor" aria-hidden="true" href="#copy-the-gitea-binary-to-a-global-location">#</a></h3>
<p>Run the following in a Terminal:</p>
<p><code>sudo cp gitea /usr/local/bin/gitea</code></p>
<h3 id="create-a-systemd-unit-file">Create a systemd unit file<a hidden class="anchor" aria-hidden="true" href="#create-a-systemd-unit-file">#</a></h3>
<p>I want Gitea to start up after a reboot so I create a systemd unit file and enable it.</p>
<p>The following uses <code>wget</code> to grab the latest version from the Gitea repo and saves a copy to the <code>/etc/systemd/system/</code> folder:</p>
<p><code>sudo wget https://raw.githubusercontent.com/go-gitea/gitea/main/contrib/systemd/gitea.service -P /etc/systemd/system/</code></p>
<p>Edit the downloaded file to start on a different port:</p>
<p><code>sudo nano /etc/systemd/system/gitea.service</code></p>
<p>By changing:</p>
<p><code>ExecStart=/usr/local/bin/gitea web --config /etc/gitea/app.ini</code></p>
<p>To:</p>
<p><code>ExecStart=/usr/local/bin/gitea web -p 3003 --config /etc/gitea/app.ini</code></p>
<h4 id="check-and-reload-gitea">Check and reload Gitea<a hidden class="anchor" aria-hidden="true" href="#check-and-reload-gitea">#</a></h4>
<p>First, enable, this will ensure that the service restarts after a reboot:</p>
<p><code>sudo systemctl enable gitea.service</code></p>
<p>Then, start the service:</p>
<p><code>sudo systemctl start gitea.service</code></p>
<p>Then, check the status of the service to see if it is running:</p>
<p><code>sudo systemctl status gitea.service</code></p>
<h3 id="finish-installation">Finish installation<a hidden class="anchor" aria-hidden="true" href="#finish-installation">#</a></h3>
<p>In a browser finish setting up the installation.</p>
<p>git.example.com</p>
<p>Site Title – Can Be Whatever You Like</p>
<p>Administrator Account Settings:</p>
<p>The first account created will automatically become an Administrator.</p>
<p>Press the big button, ‘Install Gitea’.</p>
<p>Additional users can now be enrolled or added.</p>
<p><strong>NOTE:</strong> There might be a timeout on first start.</p>
<p>Running ‘<code>sudo systemctl start gitea.service</code>‘ again seems to resolve this.</p>
<h4 id="post-install">Post Install<a hidden class="anchor" aria-hidden="true" href="#post-install">#</a></h4>
<p>As mentioned previously it is recommended to set permissions to read-only using:</p>
<p><code>sudo chmod 750 /etc/gitea</code></p>
<p><code>sudo chmod 640 /etc/gitea/app.ini</code></p>
<h2 id="connecting-with-ssh">Connecting with SSH<a hidden class="anchor" aria-hidden="true" href="#connecting-with-ssh">#</a></h2>
<p><strong>NOTE:</strong> These steps are done on the local machine that will connect to Gitea, not the server where Gitea is installed.</p>
<p>

<a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent" target="_blank" rel="nofollow noopener noreferrer">https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a>
</p>
<h3 id="key-management">Key Management<a hidden class="anchor" aria-hidden="true" href="#key-management">#</a></h3>
<h4 id="create-a-new-key">Create a new key<a hidden class="anchor" aria-hidden="true" href="#create-a-new-key">#</a></h4>
<p><code>ssh-keygen -t ed25519 -C &quot;user@example.com&quot;</code></p>
<p>Generating a key will give it a default name.</p>
<p>I don’t like the default names even though they make sense, so I rename the keys to something <em><strong>I</strong></em> can remember.</p>
<p><code>mv id_ed25519 gitea</code></p>
<p><code>mv id_ed25519.pub gitea.pub</code></p>
<h4 id="edit-the-config">Edit the config<a hidden class="anchor" aria-hidden="true" href="#edit-the-config">#</a></h4>
<p><code>sudo nano ~/.ssh/config</code></p>
<pre tabindex="0"><code>Host                    gitea
User                    git
HostName                git.example.com
IdentityFile            ~/.ssh/gitea
IdentitiesOnly=yes
</code></pre><h4 id="restart-ssh">Restart SSH<a hidden class="anchor" aria-hidden="true" href="#restart-ssh">#</a></h4>
<p><code>sudo systemctl restart ssh</code></p>
<h4 id="adding-the-ssh-key-to-the-ssh-agent">Adding the SSH key to the ssh-agent<a hidden class="anchor" aria-hidden="true" href="#adding-the-ssh-key-to-the-ssh-agent">#</a></h4>
<p>Start the ssh-agent in the background:</p>
<p><code>eval &quot;$(ssh-agent -s)&quot;</code></p>
<h4 id="add-the-ssh-private-key-to-the-ssh-agent">Add the SSH private key to the ssh-agent<a hidden class="anchor" aria-hidden="true" href="#add-the-ssh-private-key-to-the-ssh-agent">#</a></h4>
<p><code>ssh-add ~/.ssh/gitea</code></p>
<h4 id="add-the-ssh-public-key-to-gitea">Add the SSH public key to Gitea<a hidden class="anchor" aria-hidden="true" href="#add-the-ssh-public-key-to-gitea">#</a></h4>
<p>Copy the Public Key:</p>
<p><code>cat ~/.ssh/gitea.pub</code></p>
<p>Copy the Terminal output</p>
<p>Log into Gitea</p>
<p>Settings | SSH GPG Keys | Add Key</p>
<p>Key Name – Gitea SSH Key</p>
<p>Paste and ‘Add Key’</p>
<h3 id="connect-with-ssh">Connect with SSH<a hidden class="anchor" aria-hidden="true" href="#connect-with-ssh">#</a></h3>
<p>In a Terminal:</p>
<p><code>ssh gitea</code></p>
<p>Will return the expected error message:</p>
<blockquote>
<p>‘Hi there, User! You’ve successfully authenticated with the key named Gitea SSH Key, but Gitea does not provide shell access.’</p></blockquote>
<h3 id="sending-to-gitea-using-ssh">Sending to Gitea using SSH<a hidden class="anchor" aria-hidden="true" href="#sending-to-gitea-using-ssh">#</a></h3>
<p>Create a repository in Gitea e.g. ‘Arduino’.</p>
<p>Tick ‘Initialize Repository’ and create.</p>
<p>Initialise locally e.g.</p>
<p><code>cd /foo/Git/Arduino/</code></p>
<p><code>git init</code></p>
<p>Edit the config to use the SSH Key:</p>
<p><code>sudo nano /foo/Git/Arduino/.git/config</code></p>
<pre tabindex="0"><code>[remote &#34;origin&#34;]
        url = gitea:User/Arduino.git
</code></pre><p>Send (force -f) an initial commit:</p>
<p><code>git add .</code></p>
<p><code>git commit -m &quot;Initial Commit&quot;</code></p>
<p><code>git push -f origin main</code></p>
<p>Subsequent pushes using ‘<code>git push -u origin main</code>‘ will be fine.</p>
<h2 id="tinkering">Tinkering<a hidden class="anchor" aria-hidden="true" href="#tinkering">#</a></h2>
<h3 id="turn-off-registrations">Turn off registrations<a hidden class="anchor" aria-hidden="true" href="#turn-off-registrations">#</a></h3>
<p>As I noted earlier I am the only user here and only ever will be so there is no sense in having registrations open for other people to sign up to.</p>
<p>So I turn off registrations:</p>
<p><code>sudo nano /etc/gitea/app.ini</code></p>
<pre tabindex="0"><code>DISABLE_REGISTRATION = true
</code></pre><h3 id="disable-openid-sign-ins">Disable OpenID sign-ins<a hidden class="anchor" aria-hidden="true" href="#disable-openid-sign-ins">#</a></h3>
<p>Again, I’m the only user so I disable OpenID sign-ins:</p>
<pre tabindex="0"><code>[openid]
ENABLE_OPENID_SIGNIN = false
ENABLE_OPENID_SIGNUP = false
</code></pre><h3 id="set-up-mailer-mailjet">Set up Mailer (Mailjet)<a hidden class="anchor" aria-hidden="true" href="#set-up-mailer-mailjet">#</a></h3>
<p>In case I bungle something sign-in related, I can use Mailjet to resend a password to a verified email address:</p>
<pre tabindex="0"><code>[mailer]
ENABLED = true
SMTP_ADDR = in-v3.mailjet.com
SMTP_PORT = 587
USER = mailjet_user_id
PASSWD = mailjet_user_key
FROM = gitea@example.com
</code></pre><h3 id="set-the-landing-page">Set the ‘Landing Page’<a hidden class="anchor" aria-hidden="true" href="#set-the-landing-page">#</a></h3>
<p>As noted earlier, I’m the only user here and probably always will be.</p>
<p>It makes no sense to have an incoming browser land on the Gitea homepage, so rather than fiddle with nginx redirects Gitea allows the application to set a ‘landing page’.</p>
<p>In the <code>[server]</code> section, change:</p>
<pre tabindex="0"><code>LANDING_PAGE = https://server.IP/user
</code></pre><h4 id="check-and-reload-gitea-once-more">Check and reload Gitea once more<a hidden class="anchor" aria-hidden="true" href="#check-and-reload-gitea-once-more">#</a></h4>
<p>Then make sure it all still works.</p>
<p><code>sudo systemctl restart gitea.service</code></p>
<p>Then, check the ‘status’.</p>
<p><code>sudo systemctl status gitea.service</code></p>
<h2 id="some-scripts">Some scripts<a hidden class="anchor" aria-hidden="true" href="#some-scripts">#</a></h2>
<p><img alt="A screenshot of a Gitea repository. The layout will be familiar to anyone who has used GitHub in the past." loading="lazy" src="/posts/installing-gitea/02_Gitea_Repository_Screenshot.webp#center" title="A screenshot of a Gitea repository. The layout will be familiar to anyone who has used GitHub in the past.">
<em>Gitea Repository Screenshot</em></p>
<p>Gitea will look familiar to anyone who has used a remote Git repository like GitHub or Codeberg in the past.</p>
<p>However right now <em>my</em> installation is empty; it needs a few repositories migrating to it.</p>
<p>The following two (2) scripts live locally at <code>/foo/Git/</code> and assume that:</p>
<ul>
<li>
<p>A local repository exists at <code>/foo/Git/Arduino/</code></p>
</li>
<li>
<p>A local repository exists at <code>/foo/Git/Calckey/</code></p>
</li>
</ul>
<p>Also that:</p>
<ul>
<li>
<p>A remote repository exists at git.example.com/User/Arduino</p>
</li>
<li>
<p>A remote repository exists at git.example.com/User/Calckey</p>
</li>
</ul>
<p>(I keep the local repository names the same as the remote repository names to prevent brain ache.)</p>
<h3 id="git_">

<a href="https://github.com/BoffinsBlog/Gitea/blob/main/init-update/git_init_everything.sh" target="_blank" rel="nofollow noopener noreferrer">git_init_everything.sh</a>
</h3>
<p>The first script loops through all of the directory names in the array and re-initialises them.</p>
<p>It then deletes all of the local history, commits etc.</p>
<p>It then ‘pushes’ the local repository to the pre-existing remote repository.</p>
<pre tabindex="0"><code>#!/bin/bash

clear

# Re-initialise and Push everything to Gitea...
echo -e &#39;\e[1;33mRe-initialise and Push everything to Gitea...\e[0m&#39;;
echo &#39;&#39;;

function initGit {
    local -n arr=$1

    for i in &#34;${arr[@]}&#34;
    do

    # Initialise the local git repo...
    echo -e &#39;\e[1;36mInitialise the local&#39; $i &#39;git repo...\e[0m&#39;;

    # Remove the old repo...
    echo -e &#39;\e[32mRemove the old&#39; $i &#39;repo...\e[0m&#39;;
    cd /foo/$i/;
    sudo rm -R .git;

    # Create the new local repo...
    echo -e &#39;\e[32mCreate the new&#39; $i &#39;local repo...\e[0m&#39;;
    git init;

    # Update the local config file...
    echo -e &#39;\e[32mUpdate the local&#39; $i &#39;config file...\e[0m&#39;;
    echo &#39;[remote &#34;origin&#34;]&#39; &gt;&gt;  .git/config;
    echo &#39;    url = git_gitea:Boffin/&#39;$i&#39;.git&#39; &gt;&gt;  .git/config;

    # Push the local files to the remote repo with an initial commit...
    echo -e &#39;\e[32mPush the local&#39; $i &#39;files to the remote repo with an initial commit...\e[0m&#39;;
    git add .;
    git commit -m &#34;Initial Commit&#34;;
    git push -f origin main;

    # Done
    echo -e &#39;\e[1;36m&#39;$i &#39;done\e[0m&#39;;
    echo &#39;&#39;;

    done
}

# Define the array of all the directory names
array=(
    &#34;Arduino&#34;
    &#34;Calckey&#34;
    )

# Loop
initGit array

# Everything done
echo -e &#39;\e[1;33mEverything done\e[0m&#39;;
</code></pre><h3 id="git_-1">

<a href="https://github.com/BoffinsBlog/Gitea/blob/main/init-update/git_update_everything.sh" target="_blank" rel="nofollow noopener noreferrer">git_update_everything.sh</a>
</h3>
<p>Then the second script loops through all of the directory names in the array and updates them.</p>
<p>It then ‘pushes’ the local repository to the pre-existing remote repository.</p>
<pre tabindex="0"><code>#!/bin/bash

clear

# Push everything to Gitea...
echo -e &#39;\e[1;33mPush everything to Gitea...\e[0m&#39;;
echo &#39;&#39;;

function updateGit {
    local -n arr=$1

    for i in &#34;${arr[@]}&#34;
    do

    # Update the remote git repo...
    echo -e &#39;\e[1;36mUpdate the remote&#39; $i &#39;git repo...\e[0m&#39;

    cd /foo/$i/
    git add .
    git commit -m &#39;Modified&#39; .;
    git push -u origin main;

    # Done
    echo -e &#39;\e[1;36m&#39;$i &#39;done\e[0m&#39;
    echo &#39;&#39;

    done
}

# Define the array of all the directory names
array=(
    &#34;Arduino&#34;
    &#34;Calckey&#34;
    )

# Loop
updateGit array

# Everything done
echo -e &#39;\e[1;33mEverything done\e[0m&#39;;
</code></pre><p>As the traditional spaces people have used to share code and ideas disappear, or become the input for training models, I truly believe that self hosted applications like Gitea can empower us.</p>
<p>So, if you have a website living on a Pi under your telly, there’s no reason you can’t have a git repository living next to it too.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://boffinsblog.github.io/tags/linux/">Linux</a></li>
      <li><a href="https://boffinsblog.github.io/tags/raspberry-pi/">Raspberry Pi</a></li>
      <li><a href="https://boffinsblog.github.io/tags/self-hosting/">Self Hosting</a></li>
      <li><a href="https://boffinsblog.github.io/tags/software/">Software</a></li>
      <li><a href="https://boffinsblog.github.io/tags/web-servers/">Web-Servers</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://boffinsblog.github.io/posts/how-to-unbrick-a-sheevaplug/">
    <span class="title">« Prev</span>
    <br>
    <span>How to Unbrick a SheevaPlug</span>
  </a>
  <a class="next" href="https://boffinsblog.github.io/posts/pi-hole-with-unbound-and-pivpn/">
    <span class="title">Next »</span>
    <br>
    <span>Pi-hole with Unbound and PiVPN</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://boffinsblog.github.io/">Boffins Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
        <br>
        <p><a href="https://www.creativecommons.org/licenses/by-nc/4.0/deed.en" rel="noopener noreferrer" target="_blank">This work is licensed under CC BY-NC-SA 4.0</a></p>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
