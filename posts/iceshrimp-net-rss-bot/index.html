<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Iceshrimp.NET RSS Bot | Boffins Blog</title>
<meta name="keywords" content="Fediverse, Linux, Python, Raspberry Pi, Self Hosting">
<meta name="description" content="Turn an RSS feed into an Iceshrimp note. Send either the latest RSS entry or a stream of Iceshrimp posts.">
<meta name="author" content="Boffin">
<link rel="canonical" href="https://boffinsblog.github.io/posts/iceshrimp-net-rss-bot/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e13be8719bbabf4005d0d2b0f19dba897f7d41b2e807b64c47ee1436d126ab01.css" integrity="sha256-4TvocZu6v0AF0NKw8Z26iX99QbLoB7ZMR&#43;4UNtEmqwE=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://boffinsblog.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://boffinsblog.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://boffinsblog.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://boffinsblog.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://boffinsblog.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://boffinsblog.github.io/posts/iceshrimp-net-rss-bot/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="https://boffinsblog.github.io/posts/iceshrimp-net-rss-bot/">
  <meta property="og:site_name" content="Boffins Blog">
  <meta property="og:title" content="Iceshrimp.NET RSS Bot">
  <meta property="og:description" content="Turn an RSS feed into an Iceshrimp note. Send either the latest RSS entry or a stream of Iceshrimp posts.">
  <meta property="og:locale" content="en-gb">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-16T07:34:36+01:00">
    <meta property="article:modified_time" content="2024-07-16T07:34:36+01:00">
    <meta property="article:tag" content="Fediverse">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Raspberry Pi">
    <meta property="article:tag" content="Self Hosting">
    <meta property="og:image" content="https://boffinsblog.github.io/posts/iceshrimp-net-rss-bot/01_Iceshrimp_NET_GamesBot_Screenshot.webp">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://boffinsblog.github.io/posts/iceshrimp-net-rss-bot/01_Iceshrimp_NET_GamesBot_Screenshot.webp">
<meta name="twitter:title" content="Iceshrimp.NET RSS Bot">
<meta name="twitter:description" content="Turn an RSS feed into an Iceshrimp note. Send either the latest RSS entry or a stream of Iceshrimp posts.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://boffinsblog.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Iceshrimp.NET RSS Bot",
      "item": "https://boffinsblog.github.io/posts/iceshrimp-net-rss-bot/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Iceshrimp.NET RSS Bot",
  "name": "Iceshrimp.NET RSS Bot",
  "description": "Turn an RSS feed into an Iceshrimp note. Send either the latest RSS entry or a stream of Iceshrimp posts.",
  "keywords": [
    "Fediverse", "Linux", "Python", "Raspberry Pi", "Self Hosting"
  ],
  "articleBody": "Real ‘Shrimp Syndication Turning RSS feeds into an Iceshrimp.NET bot driven timeline.\nThis is a much simpler reworking of the Mastodon rss-to-toot scripts.\nWhy ?\nMastodon has a low character count per toot.\n(I am aware that character count is instance specific; don’t contact me to correct me.)\nAlso, I had to create several variants of the script to allow toots to fit this character limit.\nThen, choose the correct variant to use, to prevent toots from exceeding the character limit.\nDoing this meant that some toots were sent with, say, the RSS ‘Description’ excluded.\nMy Iceshrimp.NET instance character limit per Note allows for much longer posts.\nSo, no variants needed.\nFeeding the Bot The overall workflow concept is quite straightforward.\nThe python code takes an RSS feed.\nIt takes the latest RSS post in the feed.\nIf that RSS post is different to the last Note sent, it crafts a new Iceshrimp.NET Note announcing the new RSS content, and updates the Iceshrimp.NET timeline.\nA cron job then runs every 15 minutes to loop through this workflow, picking up and sending new additions to the RSS feed to the Iceshrimp.NET timeline.\nPrerequisites to installing the Iceshrimp.NET RSS Bot Create a new account Firstly, and while it may be stating the obvious, there needs to be an account to send the Notes FROM.\nObviously you can skip this part if you intend to use an existing account.\nTurn Registrations ON:\nnano iceshrimp.net/Iceshrimp.Backend/configuration.ini\n;; Whether to allow instance registrations ;; Options: [Closed, Invite, Open] #Registrations = Closed Registrations = Open Then, in a Terminal send a POST request:\ncurl -X 'POST' \\ 'http://localhost:3000/api/iceshrimp/auth/register' \\ -H 'accept: application/json' \\ -H 'Content-Type: application/json' \\ -H 'Host: shrimp.example.org' \\ -d '{ \"username\": \"account_name_goes_here\", \"password\": \"super_long_password_goes_here\" }' The output should be something like this:\n{\"status\":\"authenticated\",\"isAdmin\":false,\"isModerator\":false,\"token\":\"this_is_the_TOKEN\",\"user\":{\"id\":\"9fqw78arpr8rv21m\",\"username\":\"account_name_goes_here\",\"host\":null,\"displayName\":null,\"avatarUrl\":\"https://shrimp.example.org/identicon/9fqw78arpr8rv21m\",\"bannerUrl\":null,\"instanceName\":\"example.org\",\"instanceIconUrl\":null}}\nMake a note of the Authentication TOKEN Secondly, make a note of the TOKEN; it will be difficult to recreate this Terminal output.\nThis bit is the Authentication TOKEN:\n\"token\":\"this_is_the_TOKEN\"\nThen, turn the Registrations back OFF:\nnano iceshrimp.net/Iceshrimp.Backend/configuration.ini\n;; Whether to allow instance registrations ;; Options: [Closed, Invite, Open] Registrations = Closed #Registrations = Open Test the TOKEN works Finally, test to see that it all works.\nIn a Terminal post something to the instance using the TOKEN provided:\ncurl -X 'POST' \\ 'https://shrimp.example.org/api/iceshrimp/notes' \\ -H 'accept: application/json' \\ -H 'Content-Type: application/json' \\ -H \"Authorization: Bearer this_is_the_TOKEN\" \\ -d '{ \"text\": \"Test Post\", \"visibility\": \"public\" }' A couple of notes.\nFirstly, the ‘text‘ parameter is required; this is the ‘body’ of the Note.\nSecondly, the ‘visibility‘ parameter is required; the Note will fail to post without it.\nFiles for running the Iceshrimp.NET RSS Bot Keep it secret, keep it safe The Python file that contains the access TOKEN and other needed connection info:\nsecrets.py ICESHRIMP_URL = 'https://shrimp.example.org' ICESHRIMP_TOKEN = 'this_is_the_TOKEN' ICESHRIMP_NOTE = ICESHRIMP_URL + '/api/iceshrimp/notes' FEED_URL = 'rss_feed_url_goes_here' GAME_HASHTAGS = 'game_hashtags_go_here' NOTE_HASHTAGS = '#hashtag #hashtag #hashtag' FILE_PATH = '/home/foo/full_filepath_goes_here/' Sending a single Iceshrimp.NET Note This will populate an Iceshrimp timeline with a single item of RSS content.\nThe script below will post only the latest item in the RSS feed:\nbot_no_image.py #!/usr/bin/env python # -*- coding: utf-8 -*- # A bot that takes an RSS feed and posts to iceshrimp.NET # Parses the latest entry in the RSS feed and if it doesn't match the last note, sends the latest entry from secrets import * from pathlib import Path import requests import feedparser RSS_FEED = feedparser.parse(FEED_URL) RSS_ENTRY = RSS_FEED.entries[0] # Function to build the note, send it and update the 'last_note.txt' file def send_note(): # Build the headers including the ICESHRIMP_TOKEN headers = { 'accept': 'application/json', 'Content-Type': 'application/json', 'Authorization' : f'Bearer {ICESHRIMP_TOKEN}', } # Build the text part of the note from the chosen 'RSS_ENTRY' note_str = '' note_str += f\"{RSS_ENTRY['title']}\\n\\n\" note_str += f\"{RSS_ENTRY['description']}\\n\" note_str += f\"\\n\\n{RSS_ENTRY['link']}\\n\\n\" note_str += f\"\\n\\nThis is an automated post from the {GAME_HASHTAGS} RSS feed dated {RSS_ENTRY['published']}\\n\\n\" note_str += f\"\\n\\n{NOTE_HASHTAGS}\\n\\n\" # Build the payload payload = { 'text': note_str, 'visibility': 'public', } # POST the payload to the ICESHRIMP_URL response = requests.post(ICESHRIMP_NOTE, headers=headers, json=payload) # Update the 'last_note.txt' file with 'latest_entry' last_note = open(Path(FILE_PATH) / \"last_note.txt\",\"w\") last_note.write(latest_entry) last_note.close() # Update the 'last_rss.txt' file with 'published' date last_rss = open(Path(FILE_PATH) / \"last_rss.txt\",\"w\") last_rss.write(published) last_rss.close() # Output a response print(\"New note sent from the \" + GAME_HASHTAGS + \" RSS feed!\") # Find the latest RSS entry latest_entry = RSS_ENTRY.id # Find the latest published date published = RSS_ENTRY.published # Find the 'last_note' sent with open(Path(FILE_PATH) / \"last_note.txt\") as last_note: last_note = last_note.read() # If 'latest_entry' does not equal 'last_note' then send a new note based on 'latest_entry' if latest_entry != last_note: send_note() elif latest_entry == last_note: # Output a response print(\"Nothing new to add from the \" + GAME_HASHTAGS + \" RSS feed!\") Sending a stream of Notes What if we want to populate an Iceshrimp timeline with a whole stream of RSS content?\nThe following works in a similar way to the ‘Sending a single Iceshrimp Note’ approach, except it starts at the bottom of the RSS feed.\nAnd then loops upwards through the feed items.\nThat way, the latest RSS post will never be the latest Note, until the Python loop has reached the start of the RSS content.\nThe script below will cycle through all of the items in the RSS feed:\nbot_all_no_image.py #!/usr/bin/env python # -*- coding: utf-8 -*- # A bot that takes an RSS feed and posts to iceshrimp.NET # Parses the latest entry in the RSS feed and if it doesn't match the last note, sends the latest entry from secrets import * from pathlib import Path import requests import feedparser import time RSS_FEED = feedparser.parse(FEED_URL) # Function to build the note, send it and update the 'last_note.txt' file def send_note(): # Build the headers including the ICESHRIMP_TOKEN headers = { 'accept': 'application/json', 'Content-Type': 'application/json', 'Authorization' : f'Bearer {ICESHRIMP_TOKEN}', } # Build the text part of the note from the chosen 'RSS_ENTRY' note_str = '' note_str += f\"{RSS_ENTRY['title']}\\n\\n\" note_str += f\"{RSS_ENTRY['description']}\\n\" note_str += f\"\\n\\n{RSS_ENTRY['link']}\\n\\n\" note_str += f\"\\n\\nThis is an automated post from the {GAME_HASHTAGS} RSS feed dated {RSS_ENTRY['published']}\\n\\n\" note_str += f\"\\n\\n{NOTE_HASHTAGS}\\n\\n\" # Build the payload payload = { 'text': note_str, 'visibility': 'public', } # POST the payload to the ICESHRIMP_URL response = requests.post(ICESHRIMP_NOTE, headers=headers, json=payload) # Update the 'last_note.txt' file with 'latest_entry' last_note = open(Path(FILE_PATH) / \"last_note.txt\",\"w\") last_note.write(latest_entry) last_note.close() # Update the 'last_rss.txt' file with 'published' date last_rss = open(Path(FILE_PATH) / \"last_rss.txt\",\"w\") last_rss.write(published) last_rss.close() # How many RSS entries are there (-1 as the indexing starts at 0) count = len(feedparser.parse(FEED_URL)['entries'])-1 # Loop through all of the RSS entries (until it is less than 0, where the indexing started) print(\"There are\", count+1, \"RSS entries to send\") while count != -1: latest_entry = RSS_FEED.entries[count].id # Find the published date published = RSS_FEED.entries[count].published RSS_ENTRY = RSS_FEED.entries[count] #print(\"Sending - \" + RSS_FEED.entries[count].title, count, \"notes remaining\") print(\"Sending - \" + RSS_FEED.entries[count].title + \" -\", count, \"notes remaining\") send_note() count = count -1 time.sleep(1) # Output a response print(\"All done!\") RSS items and Note logging A couple of files are needed to keep track of:\nWhat the last item in an RSS feed is\nWhat the last Note sent was\nIt is by comparing these contents of these two files that the script decides whether create and send a new Note.\nThe text file that contains the ID of the last RSS entry:\nlast_rss.txt This file can start empy, it will be written to The text file that contains the ID of the last RSS entry that was posted as a Note:\nlast_note.txt This file can start empy, it will be written to Deploying the Iceshrimp.NET RSS Bot I prefer to have all of the files for a given feed in the same directory.\nHowever there is nothing to stop you having multiple bot folders, each with their own RSS feed and TOKEN.\nI have more than one Python script set up and they are all called from a bash script every 15 minutes using cron.\ncron job This is what calling one of those jobs looks like.\n# Run the Iceshrimp bot that turn RSS feeds into notes every N minutes */5 * * * * python /home/foo/bot_with_image.py \u0026 However, these individual commands could potentially be contained in a single bash script and have cron execute that instead.\nCode examples are at .\n",
  "wordCount" : "1388",
  "inLanguage": "en",
  "image":"https://boffinsblog.github.io/posts/iceshrimp-net-rss-bot/01_Iceshrimp_NET_GamesBot_Screenshot.webp","datePublished": "2024-07-16T07:34:36+01:00",
  "dateModified": "2024-07-16T07:34:36+01:00",
  "author":{
    "@type": "Person",
    "name": "Boffin"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://boffinsblog.github.io/posts/iceshrimp-net-rss-bot/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Boffins Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://boffinsblog.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://boffinsblog.github.io/" accesskey="h" title="Boffins Blog (Alt + H)">Boffins Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://boffinsblog.github.io/categories/featured/" title="Featured">
                    <span>Featured</span>
                </a>
            </li>
            <li>
                <a href="https://boffinsblog.github.io/categories" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://boffinsblog.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://boffinsblog.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://boffinsblog.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Iceshrimp.NET RSS Bot
    </h1>
    <div class="post-meta"><span title='2024-07-16 07:34:36 +0100 BST'>July 16, 2024</span>&nbsp;·&nbsp;<span>7 min</span>&nbsp;·&nbsp;<span>Boffin</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#real-shrimp-syndication" aria-label="Real ‘Shrimp Syndication">Real ‘Shrimp Syndication</a></li>
                <li>
                    <a href="#feeding-the-bot" aria-label="Feeding the Bot">Feeding the Bot</a></li>
                <li>
                    <a href="#prerequisites-to-installing-the-iceshrimpnet-rss-bot" aria-label="Prerequisites to installing the Iceshrimp.NET RSS Bot">Prerequisites to installing the Iceshrimp.NET RSS Bot</a><ul>
                        
                <li>
                    <a href="#create-a-new-account" aria-label="Create a new account">Create a new account</a></li>
                <li>
                    <a href="#make-a-note-of-the-authentication-token" aria-label="Make a note of the Authentication TOKEN">Make a note of the Authentication TOKEN</a></li>
                <li>
                    <a href="#test-the-token-works" aria-label="Test the TOKEN works">Test the TOKEN works</a></li></ul>
                </li>
                <li>
                    <a href="#files-for-running-the-iceshrimpnet-rss-bot" aria-label="Files for running the Iceshrimp.NET RSS Bot">Files for running the Iceshrimp.NET RSS Bot</a><ul>
                        
                <li>
                    <a href="#keep-it-secret-keep-it-safe" aria-label="Keep it secret, keep it safe">Keep it secret, keep it safe</a></li>
                <li>
                    <a href="#sending-a-single-iceshrimpnet-note" aria-label="Sending a single Iceshrimp.NET Note">Sending a single Iceshrimp.NET Note</a></li>
                <li>
                    <a href="#sending-a-stream-of-notes" aria-label="Sending a stream of Notes">Sending a stream of Notes</a></li>
                <li>
                    <a href="#rss-items-and-note-logging" aria-label="RSS items and Note logging">RSS items and Note logging</a></li></ul>
                </li>
                <li>
                    <a href="#deploying-the-iceshrimpnet-rss-bot" aria-label="Deploying the Iceshrimp.NET RSS Bot">Deploying the Iceshrimp.NET RSS Bot</a><ul>
                        
                <li>
                    <a href="#cron-job" aria-label="cron job">cron job</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="real-shrimp-syndication">Real ‘Shrimp Syndication<a hidden class="anchor" aria-hidden="true" href="#real-shrimp-syndication">#</a></h2>
<p>Turning RSS feeds into an Iceshrimp.NET bot driven timeline.</p>
<p>This is a much simpler reworking of the 


  <a href="/posts/rss-to-toot/">Mastodon rss-to-toot</a>
 scripts.</p>
<p>Why ?</p>
<p>Mastodon has a low character count per toot.</p>
<p>(I am aware that character count is instance specific; don’t contact me to correct me.)</p>
<p>Also, I had to create several variants of the script to allow toots to fit this character limit.</p>
<p>Then, choose the correct variant to use, to prevent toots from exceeding the character limit.</p>
<p>Doing this meant that some toots were sent with, say, the RSS ‘Description’ excluded.</p>
<p>My 


  <a href="/posts/installing-iceshrimp-net/">Iceshrimp.NET</a>
 instance character limit per Note allows for much longer posts.</p>
<p>So, no variants needed.</p>
<h2 id="feeding-the-bot">Feeding the Bot<a hidden class="anchor" aria-hidden="true" href="#feeding-the-bot">#</a></h2>
<p>The overall workflow concept is quite straightforward.</p>
<p>The python code takes an RSS feed.</p>
<p>It takes the latest RSS post in the feed.</p>
<p>If that RSS post is different to the last Note sent, it crafts a new Iceshrimp.NET Note announcing the new RSS content, and updates the Iceshrimp.NET timeline.</p>
<p>A cron job then runs every 15 minutes to loop through this workflow, picking up and sending new additions to the RSS feed to the Iceshrimp.NET timeline.</p>
<h2 id="prerequisites-to-installing-the-iceshrimpnet-rss-bot">Prerequisites to installing the Iceshrimp.NET RSS Bot<a hidden class="anchor" aria-hidden="true" href="#prerequisites-to-installing-the-iceshrimpnet-rss-bot">#</a></h2>
<h3 id="create-a-new-account">Create a new account<a hidden class="anchor" aria-hidden="true" href="#create-a-new-account">#</a></h3>
<p>Firstly, and while it may be stating the obvious, there needs to be an account to send the Notes <strong>FROM</strong>.</p>
<p>Obviously you can skip this part if you intend to use an existing account.</p>
<p>Turn Registrations <strong>ON</strong>:</p>
<p><code>nano iceshrimp.net/Iceshrimp.Backend/configuration.ini</code></p>
<pre tabindex="0"><code>;; Whether to allow instance registrations
;; Options: [Closed, Invite, Open]
#Registrations = Closed
Registrations = Open
</code></pre><p>Then, in a Terminal send a POST request:</p>
<pre tabindex="0"><code>curl -X &#39;POST&#39; \
	&#39;http://localhost:3000/api/iceshrimp/auth/register&#39; \
	-H &#39;accept: application/json&#39; \
	-H &#39;Content-Type: application/json&#39; \
	-H &#39;Host: shrimp.example.org&#39; \
	-d &#39;{
	&#34;username&#34;: &#34;account_name_goes_here&#34;,
	&#34;password&#34;: &#34;super_long_password_goes_here&#34;
	}&#39;
</code></pre><p>The output should be something like this:</p>
<p><code>{&quot;status&quot;:&quot;authenticated&quot;,&quot;isAdmin&quot;:false,&quot;isModerator&quot;:false,&quot;token&quot;:&quot;this_is_the_TOKEN&quot;,&quot;user&quot;:{&quot;id&quot;:&quot;9fqw78arpr8rv21m&quot;,&quot;username&quot;:&quot;account_name_goes_here&quot;,&quot;host&quot;:null,&quot;displayName&quot;:null,&quot;avatarUrl&quot;:&quot;https://shrimp.example.org/identicon/9fqw78arpr8rv21m&quot;,&quot;bannerUrl&quot;:null,&quot;instanceName&quot;:&quot;example.org&quot;,&quot;instanceIconUrl&quot;:null}}</code></p>
<h3 id="make-a-note-of-the-authentication-token">Make a note of the Authentication TOKEN<a hidden class="anchor" aria-hidden="true" href="#make-a-note-of-the-authentication-token">#</a></h3>
<p>Secondly, make a note of the TOKEN; it will be difficult to recreate this Terminal output.</p>
<p>This bit is the Authentication TOKEN:</p>
<p><code>&quot;token&quot;:&quot;this_is_the_TOKEN&quot;</code></p>
<p>Then, turn the Registrations back <strong>OFF</strong>:</p>
<p><code>nano iceshrimp.net/Iceshrimp.Backend/configuration.ini</code></p>
<pre tabindex="0"><code>;; Whether to allow instance registrations
;; Options: [Closed, Invite, Open]
Registrations = Closed
#Registrations = Open
</code></pre><h3 id="test-the-token-works">Test the TOKEN works<a hidden class="anchor" aria-hidden="true" href="#test-the-token-works">#</a></h3>
<p>Finally, test to see that it all works.</p>
<p>In a Terminal post something to the instance using the TOKEN provided:</p>
<pre tabindex="0"><code>curl -X &#39;POST&#39; \
	&#39;https://shrimp.example.org/api/iceshrimp/notes&#39; \
	-H &#39;accept: application/json&#39; \
	-H &#39;Content-Type: application/json&#39; \
	-H &#34;Authorization: Bearer this_is_the_TOKEN&#34; \
	-d &#39;{
	&#34;text&#34;: &#34;Test Post&#34;,
	&#34;visibility&#34;: &#34;public&#34;
	}&#39;
</code></pre><p>A couple of notes.</p>
<p>Firstly, the ‘<em>text</em>‘ parameter is required; this is the ‘body’ of the Note.</p>
<p>Secondly, the ‘<em>visibility</em>‘ parameter is required; the Note will fail to post without it.</p>
<h2 id="files-for-running-the-iceshrimpnet-rss-bot">Files for running the Iceshrimp.NET RSS Bot<a hidden class="anchor" aria-hidden="true" href="#files-for-running-the-iceshrimpnet-rss-bot">#</a></h2>
<h3 id="keep-it-secret-keep-it-safe">Keep it secret, keep it safe<a hidden class="anchor" aria-hidden="true" href="#keep-it-secret-keep-it-safe">#</a></h3>
<p>The Python file that contains the access TOKEN and other needed connection info:</p>
<h4 id="secretspy">

<a href="https://github.com/BoffinsBlog/Iceshrimp-NET/blob/main/gamesbot/secrets.py" target="_blank" rel="nofollow noopener noreferrer">secrets.py</a>
</h4>
<pre tabindex="0"><code>ICESHRIMP_URL = &#39;https://shrimp.example.org&#39;
ICESHRIMP_TOKEN = &#39;this_is_the_TOKEN&#39;
ICESHRIMP_NOTE = ICESHRIMP_URL + &#39;/api/iceshrimp/notes&#39;
FEED_URL = &#39;rss_feed_url_goes_here&#39;
GAME_HASHTAGS = &#39;game_hashtags_go_here&#39;
NOTE_HASHTAGS = &#39;#hashtag #hashtag #hashtag&#39;
FILE_PATH = &#39;/home/foo/full_filepath_goes_here/&#39;
</code></pre><h3 id="sending-a-single-iceshrimpnet-note">Sending a single Iceshrimp.NET Note<a hidden class="anchor" aria-hidden="true" href="#sending-a-single-iceshrimpnet-note">#</a></h3>
<p>This will populate an Iceshrimp timeline with a single item of RSS content.</p>
<p>The script below will post only the <strong>latest</strong> item in the RSS feed:</p>
<h4 id="bot_">

<a href="https://github.com/BoffinsBlog/Iceshrimp-NET/blob/main/gamesbot/bot_no_image.py" target="_blank" rel="nofollow noopener noreferrer">bot_no_image.py</a>
</h4>
<pre tabindex="0"><code>#!/usr/bin/env python
# -*- coding: utf-8 -*-

# A bot that takes an RSS feed and posts to iceshrimp.NET
# Parses the latest entry in the RSS feed and if it doesn&#39;t match the last note, sends the latest entry

from secrets import *
from pathlib import Path
import requests
import feedparser

RSS_FEED = feedparser.parse(FEED_URL)
RSS_ENTRY = RSS_FEED.entries[0]

# Function to build the note, send it and update the &#39;last_note.txt&#39; file
def send_note():

    # Build the headers including the ICESHRIMP_TOKEN
    headers = {
        &#39;accept&#39;: &#39;application/json&#39;,
        &#39;Content-Type&#39;: &#39;application/json&#39;,
        &#39;Authorization&#39; : f&#39;Bearer {ICESHRIMP_TOKEN}&#39;,
    }

    # Build the text part of the note from the chosen &#39;RSS_ENTRY&#39;
    note_str = &#39;&#39;
    note_str += f&#34;{RSS_ENTRY[&#39;title&#39;]}\n\n&#34;
    note_str += f&#34;{RSS_ENTRY[&#39;description&#39;]}\n&#34;
    note_str += f&#34;\n\n{RSS_ENTRY[&#39;link&#39;]}\n\n&#34;
    note_str += f&#34;\n\nThis is an automated post from the {GAME_HASHTAGS} RSS feed dated {RSS_ENTRY[&#39;published&#39;]}\n\n&#34;
    note_str += f&#34;\n\n{NOTE_HASHTAGS}\n\n&#34;

    # Build the payload
    payload = {
        &#39;text&#39;: note_str,
        &#39;visibility&#39;: &#39;public&#39;,
    }

    # POST the payload to the ICESHRIMP_URL
    response = requests.post(ICESHRIMP_NOTE, headers=headers, json=payload)

    # Update the &#39;last_note.txt&#39; file with &#39;latest_entry&#39;
    last_note = open(Path(FILE_PATH) / &#34;last_note.txt&#34;,&#34;w&#34;)
    last_note.write(latest_entry)
    last_note.close()

    # Update the &#39;last_rss.txt&#39; file with &#39;published&#39; date
    last_rss = open(Path(FILE_PATH) / &#34;last_rss.txt&#34;,&#34;w&#34;)
    last_rss.write(published)
    last_rss.close()

    # Output a response
    print(&#34;New note sent from the &#34; + GAME_HASHTAGS + &#34; RSS feed!&#34;)

# Find the latest RSS entry
latest_entry = RSS_ENTRY.id

# Find the latest published date
published = RSS_ENTRY.published

# Find the &#39;last_note&#39; sent
with open(Path(FILE_PATH) / &#34;last_note.txt&#34;) as last_note:
    last_note = last_note.read()

# If &#39;latest_entry&#39; does not equal &#39;last_note&#39; then send a new note based on &#39;latest_entry&#39;
if latest_entry != last_note:
    send_note()

elif latest_entry == last_note:
    # Output a response
    print(&#34;Nothing new to add from the &#34; + GAME_HASHTAGS + &#34; RSS feed!&#34;)
</code></pre><h3 id="sending-a-stream-of-notes">Sending a stream of Notes<a hidden class="anchor" aria-hidden="true" href="#sending-a-stream-of-notes">#</a></h3>
<p>What if we want to populate an Iceshrimp timeline with a whole stream of RSS content?</p>
<p>The following works in a similar way to the ‘Sending a single Iceshrimp Note’ approach, except it <strong>starts at the bottom of the RSS feed</strong>.</p>
<p>And then loops upwards through the feed items.</p>
<p>That way, the latest RSS post will never be the latest Note, until the Python loop has reached the start of the RSS content.</p>
<p>The script below will cycle through <strong>all</strong> of the items in the RSS feed:</p>
<h4 id="bot_-1">

<a href="https://github.com/BoffinsBlog/Iceshrimp-NET/blob/main/gamesbot/bot_all_no_image.py" target="_blank" rel="nofollow noopener noreferrer">bot_all_no_image.py</a>
</h4>
<pre tabindex="0"><code>#!/usr/bin/env python
# -*- coding: utf-8 -*-

# A bot that takes an RSS feed and posts to iceshrimp.NET
# Parses the latest entry in the RSS feed and if it doesn&#39;t match the last note, sends the latest entry

from secrets import *
from pathlib import Path
import requests
import feedparser
import time

RSS_FEED = feedparser.parse(FEED_URL)

# Function to build the note, send it and update the &#39;last_note.txt&#39; file
def send_note():

    # Build the headers including the ICESHRIMP_TOKEN
    headers = {
        &#39;accept&#39;: &#39;application/json&#39;,
        &#39;Content-Type&#39;: &#39;application/json&#39;,
        &#39;Authorization&#39; : f&#39;Bearer {ICESHRIMP_TOKEN}&#39;,
    }

    # Build the text part of the note from the chosen &#39;RSS_ENTRY&#39;
    note_str = &#39;&#39;
    note_str += f&#34;{RSS_ENTRY[&#39;title&#39;]}\n\n&#34;
    note_str += f&#34;{RSS_ENTRY[&#39;description&#39;]}\n&#34;
    note_str += f&#34;\n\n{RSS_ENTRY[&#39;link&#39;]}\n\n&#34;
    note_str += f&#34;\n\nThis is an automated post from the {GAME_HASHTAGS} RSS feed dated {RSS_ENTRY[&#39;published&#39;]}\n\n&#34;
    note_str += f&#34;\n\n{NOTE_HASHTAGS}\n\n&#34;

    # Build the payload
    payload = {
        &#39;text&#39;: note_str,
        &#39;visibility&#39;: &#39;public&#39;,
    }

    # POST the payload to the ICESHRIMP_URL
    response = requests.post(ICESHRIMP_NOTE, headers=headers, json=payload)

    # Update the &#39;last_note.txt&#39; file with &#39;latest_entry&#39;
    last_note = open(Path(FILE_PATH) / &#34;last_note.txt&#34;,&#34;w&#34;)
    last_note.write(latest_entry)
    last_note.close()

    # Update the &#39;last_rss.txt&#39; file with &#39;published&#39; date
    last_rss = open(Path(FILE_PATH) / &#34;last_rss.txt&#34;,&#34;w&#34;)
    last_rss.write(published)
    last_rss.close()

# How many RSS entries are there (-1 as the indexing starts at 0)
count = len(feedparser.parse(FEED_URL)[&#39;entries&#39;])-1

# Loop through all of the RSS entries (until it is less than 0, where the indexing started)
print(&#34;There are&#34;, count+1, &#34;RSS entries to send&#34;)
while count != -1:
    latest_entry = RSS_FEED.entries[count].id
    # Find the published date
    published = RSS_FEED.entries[count].published
    RSS_ENTRY = RSS_FEED.entries[count]
    #print(&#34;Sending - &#34; + RSS_FEED.entries[count].title, count, &#34;notes remaining&#34;)
    print(&#34;Sending - &#34; + RSS_FEED.entries[count].title + &#34; -&#34;, count, &#34;notes remaining&#34;)
    send_note()
    count = count -1
    time.sleep(1)

# Output a response
print(&#34;All done!&#34;)
</code></pre><h3 id="rss-items-and-note-logging">RSS items and Note logging<a hidden class="anchor" aria-hidden="true" href="#rss-items-and-note-logging">#</a></h3>
<p>A couple of files are needed to keep track of:</p>
<ul>
<li>
<p>What the last item in an RSS feed is</p>
</li>
<li>
<p>What the last Note sent was</p>
</li>
</ul>
<p>It is by comparing these contents of these two files that the script decides whether create and send a new Note.</p>
<p>The text file that contains the ID of the last RSS entry:</p>
<h4 id="last_">

<a href="https://github.com/BoffinsBlog/Iceshrimp-NET/blob/main/gamesbot/last_rss.txt" target="_blank" rel="nofollow noopener noreferrer">last_rss.txt</a>
</h4>
<pre tabindex="0"><code>This file can start empy, it will be written to
</code></pre><p>The text file that contains the ID of the last RSS entry that was posted as a Note:</p>
<h4 id="last_-1">

<a href="https://github.com/BoffinsBlog/Iceshrimp-NET/blob/main/gamesbot/last_note.txt" target="_blank" rel="nofollow noopener noreferrer">last_note.txt</a>
</h4>
<pre tabindex="0"><code>This file can start empy, it will be written to
</code></pre><h2 id="deploying-the-iceshrimpnet-rss-bot">Deploying the Iceshrimp.NET RSS Bot<a hidden class="anchor" aria-hidden="true" href="#deploying-the-iceshrimpnet-rss-bot">#</a></h2>
<p>I prefer to have all of the files for a given feed in the same directory.</p>
<p>However there is nothing to stop you having multiple bot folders, each with their own RSS feed and TOKEN.</p>
<p>I have more than one Python script set up and they are all called from a bash script every 15 minutes using cron.</p>
<h3 id="cron-job">cron job<a hidden class="anchor" aria-hidden="true" href="#cron-job">#</a></h3>
<p>This is what calling one of those jobs looks like.</p>
<pre tabindex="0"><code># Run the Iceshrimp bot that turn RSS feeds into notes every N minutes
*/5 * * * * python /home/foo/bot_with_image.py &amp;
</code></pre><p>However, these individual commands could potentially be contained in a single <code>bash</code> script and have <code>cron</code> execute that instead.</p>
<p>Code examples are 

<a href="https://github.com/BoffinsBlog/Iceshrimp-NET/tree/main/gamesbot/" target="_blank" rel="nofollow noopener noreferrer">at</a>
.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://boffinsblog.github.io/tags/fediverse/">Fediverse</a></li>
      <li><a href="https://boffinsblog.github.io/tags/linux/">Linux</a></li>
      <li><a href="https://boffinsblog.github.io/tags/python/">Python</a></li>
      <li><a href="https://boffinsblog.github.io/tags/raspberry-pi/">Raspberry Pi</a></li>
      <li><a href="https://boffinsblog.github.io/tags/self-hosting/">Self Hosting</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://boffinsblog.github.io/posts/iceshrimp-net-grafana-dashboard/">
    <span class="title">« Prev</span>
    <br>
    <span>Iceshrimp.NET Grafana Dashboard</span>
  </a>
  <a class="next" href="https://boffinsblog.github.io/posts/jellyfin-app-on-a-tizen-tv/">
    <span class="title">Next »</span>
    <br>
    <span>Jellyfin App on a Tizen TV</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://boffinsblog.github.io/">Boffins Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
        <br>
        <p><a href="https://www.creativecommons.org/licenses/by-nc/4.0/deed.en" rel="noopener noreferrer" target="_blank">This work is licensed under CC BY-NC-SA 4.0</a></p>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
